# docParser

–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (PDF, DOCX, TXT) —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏ —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ —Ñ–∞–π–ª.

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ `.txt`, `.docx`, `.pdf`.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ SQLite.
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ `.xlsx`.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–π CLI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

| –ö–æ–º–∞–Ω–¥–∞  | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                      |
|----------|-------------------------------------------------------------------------------------------------------------------------------|
| `parse`  | –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –≥–æ–¥—É, –ª–∏–º–∏—Ç—É, –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π, –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π dry-run                      |
| `export` | –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î –≤ Excel, —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –≥–æ–¥–∞, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤—ã–≤–æ–¥–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Ñ–∞–π–ª, –æ–ø—Ü–∏–µ–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ |
| `stats`  | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∞–Ω–Ω—ã–º: —Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥–æ–¥–∞–º, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —Ç.–¥.                              |
| `errors` | –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤/–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏–∑–æ—à–ª–∏ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏                                     |
| `clean`  | –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü –ë–î –ø–æ–ª–Ω–∞—è –∏–ª–∏ –∑–∞ –≥–æ–¥                                                                        |


## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
docparser/
‚îú‚îÄ‚îÄ .env.example         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–±—Ä–∞–∑–µ—Ü)
‚îú‚îÄ‚îÄ .gitignore           # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã Git
‚îú‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ cli.py               # –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
‚îú‚îÄ‚îÄ üöÄmain.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ docparser.db         # –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite
‚îÇ
‚îú‚îÄ‚îÄ üìÇapp/               # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ ‚öôÔ∏èconfig.py      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ crud.py          # CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ db.py            # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ models.py        # –ú–æ–¥–µ–ª–∏ SQLAlchemy —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇservices/      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ üìÇutils/         # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ üìÇdata/              # –í—Ö–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ export/              # —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —ç–∫—Å–ø–æ—Ä—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÇscripts/           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ create_db.py     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îî‚îÄ‚îÄ üìÇtests/             # –¢–µ—Å—Ç—ã
```

## –°–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Python 3.10+
- –ü–∞–∫–µ—Ç—ã –∏–∑ requirements.txt
- SQLite (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å PDF, DOCX ‚Äî —Ç—Ä–µ–±—É—é—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, pdfplumber, python-docx)


## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–æ–ø–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç —Å github –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–µ–≥–æ
git clone https://github.com/Starck43/docparser.git
cd docparser

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è Python
python -m venv .venv

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞
source .venv/bin/activate  # –∏–ª–∏ `.venv\Scripts\activate` –Ω–∞ Windows
pip install -r requirements.txt

# –°–æ–∑–¥–∞–π—Ç–µ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å–æ —Å–≤–æ–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
cp .env.example .env # –û–±—Ä–∞–∑–µ—Ü –≤ .env.example


```

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ä–∞–∑–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞)
python -m scripts.create_db 

# –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
python main.py
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞

#### –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
```bash
python cli.py parse [--data-dir PATH] [--year YEAR] [--limit N] [--dry-run] [--batch-size N] [--force-update]

    --data-dir     - –ø–∞–ø–∫–∞ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ./data)
    --year         - –≥–æ–¥ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Ç–µ–∫—É—â–∏–π –≥–æ–¥)
    --limit        - –ª–∏–º–∏—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Ä–∞–∑ (0 = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
    --dry-run      - –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞—Ä—Å–∏–Ω–≥–∞ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
    --batch-size   - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10)
    --force-update - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å

# üîπ –ü—Ä–∏–º–µ—Ä—ã
python cli.py parse --data-dir /mnt/shared/docs              # –ü–∞—Ä—Å–∏–Ω–≥ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–∏ (Linux)
python cli.py parse --data-dir D:\Shared\Docs --year 2023    # –ü–∞—Ä—Å–∏–Ω–≥ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∑–∞ 2023 ( –¥–ª—è Windows)
python cli.py parse --dry-run --limit 5                      # –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–≤—ã—Ö 5 —Ñ–∞–π–ª–æ–≤ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
python cli.py parse --force-update --batch-size 20           # –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ, –≤—ã–≤–æ–¥ –ø–æ 20 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
````

#### –≠–∫—Å–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Excel
```bash
python cli.py export [--year YEAR] [--output-dir PATH] [--limit N] [--max-per-file N] [--dry-run]  [--force]

    --year        - –≥–æ–¥ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Ç–µ–∫—É—â–∏–π –≥–æ–¥)
    --output-dir  - –ø–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ./export)
    --range       - –¥–∏–∞–ø–∞–∑–æ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
    --dry-run     - –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î –±–µ–∑ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–∞–π–ª
    --row-per-file- –º–∞–∫—Å–∏–º—É–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100)
    --force-update- –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

# üîπ –ü—Ä–∏–º–µ—Ä—ã
python cli.py export --output-dir D:\Shared\Docs --year 2024    # –≠–∫—Å–ø–æ—Ä—Ç –∑–∞ 2024 –≥–æ–¥ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–∞–ø–∫—É (–¥–ª—è Windows)
python cli.py export --range 50:200 --max-per-file 20           # –≠–∫—Å–ø–æ—Ä—Ç 50 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –Ω–∞ —Ñ–∞–π–ª—ã –ø–æ 20 –≤ —Ñ–∞–π–ª
python cli.py export --year 2025 --dry-run                      # –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —ç–∫—Å–ø–æ—Ä—Ç–∞ –∑–∞ 2025 –≥–æ–¥
python cli.py export --force-update                             # –≠–∫—Å–ø–æ—Ä—Ç —Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
```

#### –ü–æ–∏—Å–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
python cli.py errors [--year YEAR]

    --year - –≥–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–µ–∫—É—â–∏–π)
    
# üîπ –ü—Ä–∏–º–µ—Ä—ã
python cli.py errors                 # –û—à–∏–±–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
python cli.py errors --year 2024     # –û—à–∏–±–∫–∏ —Ç–æ–ª—å–∫–æ –∑–∞ 2024 –≥–æ–¥
```

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
python cli.py stats [--year YEAR]

  --year - –≥–æ–¥ –¥–ª—è —Å–±–æ—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–µ–∫—É—â–∏–π)

# üîπ –ü—Ä–∏–º–µ—Ä—ã
python cli.py stats                  # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥
python cli.py stats --year 2023      # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 2023 –≥–æ–¥
```

#### –û—á–∏—Å—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
python cli.py clean --confirm

    --year       - –≥–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–µ–∫—É—â–∏–π)
    --full-clean - –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—Å–µ –ø–µ—Ä–∏–æ–¥—ã
    --confirm    - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

# üîπ –ü—Ä–∏–º–µ—Ä—ã
python cli.py clean --year 2024                 # –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –∑–∞ 2024 –≥–æ–¥ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏—è
python cli.py clean --full-clean --confirm      # –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ–π –±–∞–∑—ã –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
```


#### –ü–æ–º–æ—â—å –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
```bash
python cli.py --help
python cli.py [command] --help

# üîπ –ü—Ä–∏–º–µ—Ä—ã
python cli.py parse --help     # –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–µ parse
python cli.py export --help    # –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ —ç–∫—Å–ø–æ—Ä—Ç—É
```
